---
title: "Multiple Regression"
author: "Devan Becker"
format: live-html
engine: knitr
webr:
  packages:
    - ggplot2
    - broom
    - dplyr
    - palmerpenguins
  render-df: paged-table
---

{{< include ./_extensions/r-wasm/live/_knitr.qmd >}}

## Load the Data

As usual, load all packages at the start of your document so that everyone knows what packages they'll need to install.

Technical note: R version 4.5 includes the `penguins` data as part of the default installation, but with different column names. So that we're all on the same page, we'll use the `palmerpenguins` package.

```{webr}
library(ggplot2)
theme_set(theme_bw())
#library(patchwork)
library(broom)
library(dplyr)
library(palmerpenguins)

data(penguins)
head(penguins)
```

## Basic Exploratory Plots

```{webr}
gg1 <- ggplot(data = penguins) +
    aes(x = flipper_length_mm, y = body_mass_g) +
    geom_point(na.rm = TRUE) +
    geom_smooth(
        method = "lm", formula = y ~ x, se = FALSE,
        na.rm = TRUE
    )

gg2 <- ggplot(data = penguins) +
    aes(x = bill_length_mm, y = body_mass_g) +
    geom_point(na.rm = TRUE) +
    geom_smooth(
        method = "lm", formula = y ~ x, se = FALSE
        na.rm = TRUE
    )

gg1
gg2
```

## Model Fitting!

Here's some code to fit a simple linear regression model to the data.

```{webr}
lm_flip <- lm(body_mass_g ~ flipper_length_mm, data = penguins)

cat("Summary statistics:\n")
glance(lm_flip)

cat("Coefficients:\n")
tidy(lm_flip)

```

Change to code below to fit your own multiple linear regression models!

```{webr}
lm_flip <- lm(body_mass_g ~ flipper_length_mm, data = penguins)
lm_bill_length_mm <- lm(body_mass_g ~ bill_length_mm, data = penguins)

bind_rows(
    flip = glance(lm_flip),
    bill_len = glance(lm_bill_length_mm),
    .id = "model"
)

bind_rows(
    flip = tidy(lm_flip),
    bill_len = tidy(lm_bill_length_mm),
    .id = "model"
) |>
    arrange(term, model)

par(mfrow = c(2, 2))
plot(lm_flip)
```


## Playground

I'll use this code chunk in lecture. Feel free to use it for whatever you want!

```{webr}

```
